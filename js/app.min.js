const initialLink=SitePaths.root.replace(/\/$/,"")+SitePaths.currentRoute,eventQ=new Vue,wpArchive=function(e){return{template:e,props:["post"]}};let initError=!1,rootPath="/";SitePaths.home.length>SitePaths.root.length&&(rootPath=SitePaths.home.replace(SitePaths.root,"/"));var vueJSmenuMethodsModule=function(e){return e.relativeUrl=function(e){return e.url.replace(SitePaths.root,"/")},e.linKey=function(e){return e.object+"s/"+e.object_id},e.itemClass=function(e){let t="menu-item";return e.url===document.location&&(t+=" menu-selected"),t},e}(vueJSmenuMethodsModule||{}),vueJSmenuComputedModule=vueJSmenuComputedModule||{};const vjsMenu=function(e){return void 0===e&&(e="primary"),void 0===InitialMenu[e]?null:{template:"#"+e+"-menu",props:["menu"],methods:vueJSmenuMethodsModule,computed:vueJSmenuComputedModule}},initMenu=function(e){return void 0===InitialMenu[e]?null:InitialMenu[e]},vjsLang=function(){return void 0===InitialMenu.languages?null:{template:"#language-menu",props:["languages","current"]}},routes=[];var customReactiveData=customReactiveData||{};const componentData={status:"",menus:{primary:initMenu("primary"),footer:initMenu("footer"),network:initMenu("network"),languages:initMenu("languages")},permalink:initialLink,logo:{src:SitePaths.logo,link:rootPath,_links:{self:WPrestPath.frontpage},object:InitialPage.homelink.object,type:InitialPage.homelink.type},posts:[],homepage:!1,rest:WPrestPath.current,type:InitialPage.type,single:InitialPage.single,archive:InitialPage.archive,istax:!1,taxonomy:"",term:"",lang:"en",custom:{},form:customReactiveData,styles:""};void 0!==InitialMenu.languages&&(componentData.lang=InitialPage.lang),InitialPage.is404&&(componentData.posts[0]=InitialPage.content404),wpGurusVueJSlocal.debug&&!InitialMenu.enabled&&(console.log("--------- SETUP ERROR ---------"),console.log(InitialMenu.error),componentData.posts[0]={title:{rendered:"Setup Error"},content:{rendered:"<p>"+InitialMenu.error+"</p>"}},initError=!0);var vueJSlogoMethodsModule=vueJSlogoMethodsModule||{},vueJSlogoComputedModule=vueJSlogoComputedModule||{};const compLogo={template:"#logo-image",props:["logo"],methods:vueJSlogoMethodsModule,computed:vueJSlogoComputedModule};var vueJSmethodsModule=function(e){return e.isPage=function(e){return"page"==this.data.type&&e==this.$route.path||"page"==this.data.type},e.isSingle=function(e){return console.log("isSingle"),console.log(e),console.log(this.data.type),!(this.data.type!=e||!this.data.single)||!(void 0!==e||!this.data.single)},e.isArchive=function(e){return!(this.data.type!=e||!this.data.archive)||!(void 0!==e||!this.data.archive)},e.isTaxonomy=function(e){return!(this.data.taxonomy!=e||!this.data.istax)||!(void 0!==e||!this.data.istax)},e.hasMenu=function(e){let t=!0;return void 0===this.data.menus[e]&&(t=!1),t},e.articleId=function(e){return"post-"+e.id},e.childLink=function(e){return SitePaths.root.replace(/\/$/,"")+this.$route.path+e},e.pageClass=function(){let e="";switch(!0){case this.data.istax:e="taxonomy-"+this.data.taxonomy+" taxonomy";break;default:e=this.data.type}switch(!0){case this.data.archive:e+="-archive";break;case this.data.single:e+="-single"}return e},e}(vueJSmethodsModule||{}),vueJSasyncMethodsModule=vueJSasyncMethodsModule||{},vueJSasyncComputedModule=vueJSasyncComputedModule||{};const pageComponent=function(e){let t="async-template";return void 0===e&&(e="<em>No Data</em>",t="static-template"),Vue.component("body-content",{template:"#body-content",components:{"primary-menu":vjsMenu("primary"),"footer-menu":vjsMenu("footer"),"network-menu":vjsMenu("network"),"language-menu":void 0===InitialMenu.languages?null:{template:"#language-menu",props:["languages","current"]},"logo-image":compLogo,"static-template":{template:"#static-template",computed:vueJScomputedModule,methods:vueJSmethodsModule},"async-template":{template:e,props:["rootdata"],computed:vueJSasyncComputedModule,methods:vueJSasyncMethodsModule}},data:function(){return{currentComponent:t,data:componentData}},computed:vueJScomputedModule,methods:vueJSmethodsModule,created:function(){let e=SitePaths.root.replace(/\/$/,"")+this.$route.path,t=SitePaths.home;wpGurusVueJSlocal.debug&&console.log("Route path:"+this.$route.path);let o,n="",a=this.$route.path,u=InitialPage.is404&&SitePaths.currentRoute==a;if(void 0!==VueCustomRoutes.vues[a]){switch(initError||(componentData.posts=[]),o=(n=VueCustomRoutes.vues[a]).rest,u&&InitialPage.page404>0&&(o=WPrestPath.current),componentData.type=n.post,componentData.archive=!1,componentData.single=!1,n.type){case"archive":componentData.archive=!0;break;case"single":componentData.single=!0}componentData.istax=!1,componentData.taxonomy="",void 0!==n.taxonomy&&(componentData.istax=!0,componentData.taxonomy=n.taxonomy),componentData.term="",void 0!==n.term&&(componentData.term=n.term),wpGurusVueJSlocal.debug&&console.log("Vue rest request: "+o);let s=[this.$http.get(o)],l=0,i="";if(void 0!==InitialMenu.languages&&void 0!==WPrestPath.languages){l++;let o=WPrestPath.languages;if(e!==t){let e=a.split("/");0==(i=e[e.length-1]).length&&(i=e[e.length-2]),o=WPrestPath.languages+i}switch(!0){case componentData.istax:o=WPrestPath.languages+componentData.term+"?tax="+componentData.taxonomy;break;case componentData.archive:o+="?archive="+componentData.type;break;case componentData.single:o+="?ptype="+componentData.type}wpGurusVueJSlocal.debug&&console.log("translate page: "+o),s[l]=this.$http.get(o)}if(void 0!==VueCustomRoutes.routes[a]){wpGurusVueJSlocal.debug&&console.log("found extra rest resquest:");for(let e in VueCustomRoutes.routes[a]){l++;let t=VueCustomRoutes.routes[a][e];s[l]=this.$http.get(t),wpGurusVueJSlocal.debug&&console.log(VueCustomRoutes.routes[a][e])}}if(void 0!==VueCustomRoutes.vues[a].script&&VueCustomRoutes.vues[a].script.length>0)for(let e in VueCustomRoutes.vues[a].script){l++;let t=VueCustomRoutes.vues[a].script[e];s[l]=this.$http.get(t)}if(initError)return;Promise.all(s).then(o=>{if(o[l=0].body instanceof Array?componentData.posts=o[l].body:componentData.posts=[o[l].body],componentData.homepage=e===t,void 0!==InitialMenu.languages&&void 0!==WPrestPath.languages){let e=o[++l].body;if(t==o[l].body[componentData.lang].url&&i.length>0&&componentData.archive&&!componentData.istax){wpGurusVueJSlocal.debug&&console.log("translated pages: ");for(let t in e)e[t].url+=i+"/",wpGurusVueJSlocal.debug&&console.log(e[t].url)}componentData.menus.languages=e}if(componentData.custom={},void 0!==VueCustomRoutes.routes[this.$route.path])for(let e in VueCustomRoutes.routes[this.$route.path])l++,componentData.custom[e]=o[l].body,wpGurusVueJSlocal.debug&&console.log("added custom data: "+e),wpGurusVueJSlocal.debug&&console.log(componentData.custom[e]);let n=document.getElementsByTagName("head")[0],u=n.getElementsByClassName("asynchronous-script");for(let e=0;e<u.length;e++)n.removeChild(u[e]);if(void 0!==VueCustomRoutes.vues[a].script&&VueCustomRoutes.vues[a].script.length>0)for(let e in VueCustomRoutes.vues[a].script){let t;switch(l++,e){case"css":(t=document.createElement("style")).type="text/css",t.appendChild(document.createTextNode(o[l].body));break;default:(t=document.createElement("script")).type="text/"+e}t.class="asynchronous-script",n.appendChild(t)}this.data=componentData},e=>{wpGurusVueJSlocal.debug&&console.log("ERROR,failed to get api data"),wpGurusVueJSlocal.debug&&console.log(e),this.status={error:"failed to load the page"}})}},updated:function(){var e,t;if(Array.from(document.getElementsByClassName("wpgurus-inner-styles")).forEach(e=>e.remove()),this.data.posts.length>0&&void 0!==this.data.posts[0].wg_inline_style&&this.data.single)for(let o in this.data.posts[0].wg_inline_style)e="wpgurus-inline-style-"+o,o.length>1&&(e=o),t=document.getElementById(e),wpGurusVueJSlocal.debug&&console.log("creating <style> element: "+e),(t=document.createElement("style")).type="text/css",t.id=e,t.class="wpgurus-inner-styles",document.head.appendChild(t),t.innerText=this.data.posts[0].wg_inline_style[o];let o=new CustomEvent("wpgurus-vuejs-updated",{detail:{message:"Mounted VueJs",time:new Date},bubbles:!0,cancelable:!0});document.body.dispatchEvent(o),wpGurusVueJSlocal.debug&&console.log("vuejs updated")}})},getRoutes=function(e,t){if(void 0!==InitialMenu[e]&&InitialMenu.enabled&&InitialMenu[e].items.length>0)for(let o=0;o<InitialMenu[e].items.length;o++)void 0!==InitialMenu[e].items[o].isvjslink&&InitialMenu[e].items[o].isvjslink&&(routes[routes.length]={path:InitialMenu[e].items[o].url.replace(SitePaths.root,"/"),component:t})};wpGurusVueJSlocal.debug&&console.log("Custom routes:"),wpGurusVueJSlocal.debug&&console.log(VueCustomRoutes.routes);const bodyComponent=pageComponent();void 0===VueCustomRoutes.vues[rootPath].async&&(routes[routes.length]={path:rootPath,component:bodyComponent});const asyncVues=[];for(let e in VueCustomRoutes.vues)void 0!==VueCustomRoutes.vues[e].async&&VueCustomRoutes.vues[e].async?asyncVues[e]=VueCustomRoutes.vues[e]:routes[routes.length]={path:e,component:bodyComponent};wpGurusVueJSlocal.debug&&console.log("page routes"),wpGurusVueJSlocal.debug&&console.log(routes);const router=new VueRouter({routes:routes,mode:"history"});router.beforeEach(function(e,t,o){if(e.path in asyncVues){o(!1),wpGurusVueJSlocal.debug&&console.log("Async route:"+e.path);let t=asyncVues[e.path].rest;delete asyncVues[e.path],new Promise(function(e,o){const n=new XMLHttpRequest;n.open("GET",t),n.onload=(()=>200===n.status?e(n.response):o(Error(n.statusText))),n.onerror=(e=>o(Error(`Network Error: ${e}`))),n.send()}).then(function(t){let o=JSON.parse(t).content.rendered;0==o.length&&(o="<em>Empty page</em>"),router.addRoutes([{path:e.path,component:pageComponent(o)}])}).catch(function(e){console.log("Async route error:"),console.log(e)})}o()});const mv=new Vue({router:router}).$mount("#main-vue");
